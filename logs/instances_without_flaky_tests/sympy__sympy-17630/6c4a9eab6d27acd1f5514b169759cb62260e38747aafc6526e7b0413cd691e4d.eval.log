2024-07-03 02:57:41,896 - INFO - Environment image sweb.env.x86_64.c795f4b88616b8462021ed:latest found for sympy__sympy-17630
Building instance image sweb.eval.x86_64.sympy__sympy-17630:latest for sympy__sympy-17630
2024-07-03 02:57:41,897 - INFO - Image sweb.eval.x86_64.sympy__sympy-17630:latest already exists, skipping build.
2024-07-03 02:57:41,897 - INFO - Creating container for sympy__sympy-17630...
2024-07-03 02:57:43,984 - INFO - Container for sympy__sympy-17630 created: b5359b8b5e0567b2a6763e1c43e0de27cf73b3c8c6cfb0906a898ac4aa85d081
2024-07-03 02:57:44,155 - INFO - Container for sympy__sympy-17630 started: b5359b8b5e0567b2a6763e1c43e0de27cf73b3c8c6cfb0906a898ac4aa85d081
2024-07-03 02:57:44,155 - INFO - Intermediate patch for sympy__sympy-17630 written to /scratch/rse-swe-bench/unit_test_logs/evaluation_138450/model_name_managed_by_server/sympy__sympy-17630/patch.diff, now applying to container...
2024-07-03 02:57:44,289 - INFO - >>>>> Applied Patch:
Checking patch sympy/matrices/expressions/blockmatrix.py...
Applied patch sympy/matrices/expressions/blockmatrix.py cleanly.

2024-07-03 02:57:44,662 - INFO - Git diff before:
diff --git a/sympy/matrices/expressions/blockmatrix.py b/sympy/matrices/expressions/blockmatrix.py
index 95302a05ca..9c9fe37e2e 100644
--- a/sympy/matrices/expressions/blockmatrix.py
+++ b/sympy/matrices/expressions/blockmatrix.py
@@ -162,10 +162,12 @@ def structurally_equal(self, other):
             and self.colblocksizes == other.colblocksizes)
 
     def _blockmul(self, other):
-        if (isinstance(other, BlockMatrix) and
-                self.colblocksizes == other.rowblocksizes):
-            return BlockMatrix(self.blocks*other.blocks)
-
+        if isinstance(other, BlockMatrix):
+            if any(isinstance(block, ZeroMatrix) for row in self.blocks for block in row) or \
+               any(isinstance(block, ZeroMatrix) for row in other.blocks for block in row):
+                new_blocks = [[self.blocks[i][k] * other.blocks[k][j] for k in range(self.blockshape[1])] for i in range(self.blockshape[0]) for j in range(other.blockshape[1])]
+                return BlockMatrix(new_blocks)
+            return BlockMatrix(self.blocks * other.blocks)
         return self * other
 
     def _blockadd(self, other):
2024-07-03 02:57:44,662 - INFO - Eval script for sympy__sympy-17630 written to /scratch/rse-swe-bench/unit_test_logs/evaluation_138450/model_name_managed_by_server/sympy__sympy-17630/patch.diff, now applying to container...
2024-07-03 03:27:44,775 - INFO - Attempting to stop container sweb.eval.sympy__sympy-17630.evaluation_138450...
2024-07-03 03:27:46,177 - INFO - Attempting to remove container sweb.eval.sympy__sympy-17630.evaluation_138450...
2024-07-03 03:27:46,255 - INFO - Container sweb.eval.sympy__sympy-17630.evaluation_138450 removed.
