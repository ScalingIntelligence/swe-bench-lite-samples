{
  "info": {
    "duration": 168.05732107162476,
    "submission": "diff --git a/django/forms/models.py b/django/forms/models.py\nindex 35ecdc1c0d..7be4b15ccf 100644\n--- a/django/forms/models.py\n+++ b/django/forms/models.py\n@@ -376,6 +376,8 @@ class BaseModelForm(BaseForm, AltersData):\n         )\n         for formfield in self.fields.values():\n             apply_limit_choices_to_to_formfield(formfield)\n+            if isinstance(formfield, SimpleArrayField):\n+                formfield.show_hidden_initial = False\n \n     def _get_validation_exclusions(self):\n         \"\"\"\n",
    "total_cost": 0.130554,
    "instance_id": "django__django-16229",
    "evaluation_name": "run_on_remaining_250_for_july_4_t_1.6"
  },
  "name": "AgenticLoop",
  "transitions": [
    {
      "name": "SearchCode",
      "state": {
        "model": "deepseek-coder",
        "message": null,
        "max_tokens": 1000,
        "temperature": 1.6,
        "max_iterations": null,
        "max_search_results": 25,
        "support_test_files": false,
        "initial_context_tokens": 4000,
        "initial_search_results": 50,
        "include_message_history": true,
        "provide_initial_context": true,
        "initial_context_spans_per_file": 5,
        "max_retries_with_any_file_context": 3
      },
      "actions": [
        {
          "action": {
            "complete": false,
            "scratch_pad": "The issue involves model forms with callable defaults that fail to propagate correctly, especially with ArrayField in admin inlines. When validation errors occur and the form is resubmitted without changes, the issue causes the inline to be dismissed without errors. This might be related to how the form handles hidden initial values. Investigating the ModelForm, ArrayField handling, and admin inline formsets should reveal the root cause.",
            "search_requests": [
              {
                "query": "ModelForm fields with callable defaults",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/forms/models.py",
                "function_names": []
              },
              {
                "query": "ArrayField handling in forms",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/contrib/postgres/fields/array.py",
                "function_names": []
              },
              {
                "query": "admin inline formsets handling",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/contrib/admin/options.py",
                "function_names": []
              }
            ]
          },
          "output": {
            "complete": false,
            "ranked_spans": [
              {
                "rank": 0,
                "tokens": 5,
                "span_id": "ModelFormOptions",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 1,
                "tokens": 240,
                "span_id": "docstring",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 2,
                "tokens": 669,
                "span_id": "modelform_factory",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 3,
                "tokens": 724,
                "span_id": "fields_for_model",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 4,
                "tokens": 383,
                "span_id": "modelformset_factory",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 5,
                "tokens": 10,
                "span_id": "BaseModelForm",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 6,
                "tokens": 39,
                "span_id": "BaseModelFormSet.initial_form_count",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 6,
                "tokens": 59,
                "span_id": "BaseModelFormSet",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 6,
                "tokens": 41,
                "span_id": "BaseModelFormSet._existing_object",
                "file_path": "django/forms/models.py"
              },
              {
                "rank": 0,
                "tokens": 104,
                "span_id": "imports",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 1,
                "tokens": 74,
                "span_id": "ArrayField.run_validators",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 1,
                "tokens": 53,
                "span_id": "ArrayField.formfield",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 2,
                "tokens": 30,
                "span_id": "ArrayField.db_parameters",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 2,
                "tokens": 66,
                "span_id": "ArrayField.value_to_string",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 2,
                "tokens": 43,
                "span_id": "ArrayField._from_db_value",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 2,
                "tokens": 50,
                "span_id": "ArrayField.get_db_prep_value",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 2,
                "tokens": 19,
                "span_id": "ArrayField.description",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 2,
                "tokens": 26,
                "span_id": "ArrayField.set_attributes_from_name",
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "rank": 0,
                "tokens": 310,
                "span_id": "ModelAdmin._create_formsets",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 0,
                "tokens": 96,
                "span_id": "ModelAdmin.get_formset_kwargs",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 1,
                "tokens": 308,
                "span_id": "ModelAdmin.get_inline_formsets",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 2,
                "tokens": 28,
                "span_id": "InlineModelAdmin.get_extra",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 2,
                "tokens": 31,
                "span_id": "InlineModelAdmin.get_max_num",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 2,
                "tokens": 95,
                "span_id": "InlineModelAdmin.media",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 2,
                "tokens": 30,
                "span_id": "InlineModelAdmin.get_min_num",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 2,
                "tokens": 123,
                "span_id": "InlineModelAdmin",
                "file_path": "django/contrib/admin/options.py"
              },
              {
                "rank": 3,
                "tokens": 740,
                "span_id": "InlineModelAdmin.get_formset",
                "file_path": "django/contrib/admin/options.py"
              }
            ],
            "search_requests": [
              {
                "query": "ModelForm fields with callable defaults",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/forms/models.py",
                "function_names": []
              },
              {
                "query": "ArrayField handling in forms",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/contrib/postgres/fields/array.py",
                "function_names": []
              },
              {
                "query": "admin inline formsets handling",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/contrib/admin/options.py",
                "function_names": []
              }
            ]
          },
          "input_tokens": 3102,
          "output_tokens": 221,
          "retry_message": null,
          "completion_cost": 0.012621
        }
      ]
    },
    {
      "name": "IdentifyCode",
      "state": {
        "model": "deepseek-coder",
        "query": null,
        "class_name": null,
        "max_tokens": 1000,
        "temperature": 1.6,
        "code_snippet": null,
        "file_pattern": null,
        "ranked_spans": [
          {
            "rank": 0,
            "tokens": 5,
            "span_id": "ModelFormOptions",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 0,
            "tokens": 104,
            "span_id": "imports",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 0,
            "tokens": 310,
            "span_id": "ModelAdmin._create_formsets",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 0,
            "tokens": 96,
            "span_id": "ModelAdmin.get_formset_kwargs",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 1,
            "tokens": 240,
            "span_id": "docstring",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 1,
            "tokens": 74,
            "span_id": "ArrayField.run_validators",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 1,
            "tokens": 53,
            "span_id": "ArrayField.formfield",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 1,
            "tokens": 308,
            "span_id": "ModelAdmin.get_inline_formsets",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 2,
            "tokens": 669,
            "span_id": "modelform_factory",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 2,
            "tokens": 30,
            "span_id": "ArrayField.db_parameters",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 2,
            "tokens": 66,
            "span_id": "ArrayField.value_to_string",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 2,
            "tokens": 43,
            "span_id": "ArrayField._from_db_value",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 2,
            "tokens": 50,
            "span_id": "ArrayField.get_db_prep_value",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 2,
            "tokens": 19,
            "span_id": "ArrayField.description",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 2,
            "tokens": 26,
            "span_id": "ArrayField.set_attributes_from_name",
            "file_path": "django/contrib/postgres/fields/array.py"
          },
          {
            "rank": 2,
            "tokens": 28,
            "span_id": "InlineModelAdmin.get_extra",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 2,
            "tokens": 31,
            "span_id": "InlineModelAdmin.get_max_num",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 2,
            "tokens": 95,
            "span_id": "InlineModelAdmin.media",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 2,
            "tokens": 30,
            "span_id": "InlineModelAdmin.get_min_num",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 2,
            "tokens": 123,
            "span_id": "InlineModelAdmin",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 3,
            "tokens": 724,
            "span_id": "fields_for_model",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 3,
            "tokens": 740,
            "span_id": "InlineModelAdmin.get_formset",
            "file_path": "django/contrib/admin/options.py"
          },
          {
            "rank": 4,
            "tokens": 383,
            "span_id": "modelformset_factory",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 5,
            "tokens": 10,
            "span_id": "BaseModelForm",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 6,
            "tokens": 39,
            "span_id": "BaseModelFormSet.initial_form_count",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 6,
            "tokens": 59,
            "span_id": "BaseModelFormSet",
            "file_path": "django/forms/models.py"
          },
          {
            "rank": 6,
            "tokens": 41,
            "span_id": "BaseModelFormSet._existing_object",
            "file_path": "django/forms/models.py"
          }
        ],
        "function_name": null,
        "expand_context": true,
        "max_iterations": null,
        "max_prompt_file_tokens": 4000,
        "include_message_history": false
      },
      "actions": [
        {
          "action": {
            "scratch_pad": "The reported issue seems to be related to the handling of ArrayField with callable defaults in ModelForms, specifically when dealing with validation in the admin interface. The provided search results contain code from Django's forms.models, contrib.postgres.fields, and contrib.admin.options modules. I will analyze these results to identify the relevant code spans. From the issue description, key points include: 1) ModelForm not propagating default values correctly for ArrayField. 2) Issues with validation bypassing when submitting the form multiple times. 3) The necessity to handle hidden inputs containing initial values. Considering these points, I will focus on identifying code spans that deal with ModelForm initialization, FormSet handling, and ArrayField processing. The BaseModelForm and BaseModelFormSet classes, along with the fields_for_model function, seem particularly relevant for understanding how form fields are initialized and how data validation is managed.",
            "identified_spans": [
              {
                "span_ids": [
                  "BaseModelForm.__init__",
                  "fields_for_model"
                ],
                "file_path": "django/forms/models.py"
              },
              {
                "span_ids": [
                  "ArrayField"
                ],
                "file_path": "django/contrib/postgres/fields/array.py"
              },
              {
                "span_ids": [
                  "ModelAdmin._create_formsets",
                  "InlineModelAdmin.get_formset"
                ],
                "file_path": "django/contrib/admin/options.py"
              }
            ]
          },
          "output": {},
          "input_tokens": 6087,
          "output_tokens": 367,
          "retry_message": null,
          "completion_cost": 0.023766
        }
      ]
    },
    {
      "name": "DecideRelevance",
      "state": {
        "model": "deepseek-coder",
        "max_tokens": 1000,
        "temperature": 1.6,
        "expand_context": true,
        "max_iterations": null,
        "max_prompt_file_tokens": 4000,
        "include_message_history": false,
        "finish_after_relevant_count": 2
      },
      "actions": [
        {
          "action": {
            "complete": true,
            "relevant": true,
            "scratch_pad": "The provided file context contains relevant code for handling ModelForm and ArrayField in Django's admin interface. It includes implementations for ModelFormMetaclass, BaseModelForm, and ArrayField, which directly relate to the issue of callable defaults not propagating correctly and the handling of ArrayField in admin inlines. The code covers initialization, validation, and form processing, which are key aspects of the issue described. The file context also includes related admin configurations like InlineModelAdmin and ModelAdmin, which are crucial for understanding how inline forms are managed within the admin interface. This comprehensive coverage suggests that all the necessary relevant code for addressing the issue is present in the provided context.",
            "search_suggestions": null
          },
          "output": {},
          "input_tokens": 6048,
          "output_tokens": 174,
          "retry_message": null,
          "completion_cost": 0.020754
        }
      ]
    },
    {
      "name": "PlanToCode",
      "state": {
        "diff": null,
        "model": "deepseek-coder",
        "message": null,
        "max_tokens": 1000,
        "temperature": 1.6,
        "max_iterations": 8,
        "finish_on_review": false,
        "verification_errors": null,
        "max_prompt_file_tokens": 4000,
        "include_message_history": true,
        "allow_hallucinated_spans": false,
        "max_tokens_in_edit_prompt": 500,
        "expand_context_with_related_spans": true
      },
      "actions": [
        {
          "action": {
            "action": "modify",
            "finish": null,
            "reject": null,
            "span_id": "RelatedModelForm.__init__",
            "file_path": "admin.py",
            "scratch_pad": "The issue arises because the hidden input containing the initial value for the ArrayField is not being correctly reset after a validation error. This can be fixed by ensuring that the 'show_hidden_initial' attribute is set to False during form initialization for the specific ArrayField in question. This change should be made in the '__init__' method of the RelatedModelForm class.",
            "instructions": "Modify the '__init__' method of the RelatedModelForm class to include the 'show_hidden_initial' attribute for the 'plop' field with the value set to False."
          },
          "output": null,
          "input_tokens": 6479,
          "output_tokens": 183,
          "retry_message": "File admin.py is not found in the file context. You can only request changes to files that are in file context:\n * django/forms/models.py\n * django/contrib/postgres/fields/array.py\n * django/contrib/admin/options.py\n",
          "completion_cost": 0.022182
        },
        {
          "action": {
            "action": "modify",
            "finish": null,
            "reject": null,
            "span_id": "BaseModelForm.__init__",
            "file_path": "django/forms/models.py",
            "scratch_pad": "The file admin.py is not available in the provided context, so I cannot directly modify it. However, the issue can be addressed by ensuring that the initial value for the ArrayField is correctly managed within the Django forms framework. Specifically, we need to ensure that the initial value is not inadvertently retained after a validation error. This can be achieved by carefully managing how initial data is handled in the form. I will propose changes in the relevant parts of django/forms/models.py to ensure that initial data for ArrayField is correctly managed.",
            "instructions": "Update the '__init__' method of the BaseModelForm class in django/forms/models.py to ensure that initial data for fields, especially ArrayField, is correctly managed. Specifically, ensure that the initial value of ArrayField is not retained after a validation error."
          },
          "output": {
            "span_id": "BaseModelForm.__init__",
            "end_line": 378,
            "file_path": "django/forms/models.py",
            "start_line": 334,
            "instructions": "Update the '__init__' method of the BaseModelForm class in django/forms/models.py to ensure that initial data for fields, especially ArrayField, is correctly managed. Specifically, ensure that the initial value of ArrayField is not retained after a validation error."
          },
          "input_tokens": 6727,
          "output_tokens": 238,
          "retry_message": null,
          "completion_cost": 0.023751
        }
      ]
    },
    {
      "name": "EditCode",
      "state": {
        "model": "deepseek-coder",
        "verify": true,
        "span_id": "BaseModelForm.__init__",
        "end_line": 378,
        "file_path": "django/forms/models.py",
        "max_tokens": 1000,
        "start_line": 334,
        "temperature": 1.6,
        "instructions": "Update the '__init__' method of the BaseModelForm class in django/forms/models.py to ensure that initial data for fields, especially ArrayField, is correctly managed. Specifically, ensure that the initial value of ArrayField is not retained after a validation error.",
        "max_iterations": 8,
        "chain_of_thought": false,
        "show_file_context": true,
        "show_initial_message": true,
        "max_prompt_file_tokens": 4000,
        "include_message_history": true
      },
      "actions": [
        {
          "action": {
            "content": "```\n<replace>\n    def __init__(\n        self,\n        data=None,\n        files=None,\n        auto_id=\"id_%s\",\n        prefix=None,\n        initial=None,\n        error_class=ErrorList,\n        label_suffix=None,\n        empty_permitted=False,\n        instance=None,\n        use_required_attribute=None,\n        renderer=None,\n    ):\n        opts = self._meta\n        if opts.model is None:\n            raise ValueError(\"ModelForm has no model class specified.\")\n        if instance is None:\n            # if we didn't get an instance, instantiate a new one\n            self.instance = opts.model()\n            object_data = {}\n        else:\n            self.instance = instance\n            object_data = model_to_dict(instance, opts.fields, opts.exclude)\n        # if initial was provided, it should override the values from instance\n        if initial is not None:\n            object_data.update(initial)\n        # self._validate_unique will be set to True by BaseModelForm.clean().\n        # It is False by default so overriding self.clean() and failing to call\n        # super will stop validate_unique from being called.\n        self._validate_unique = False\n        super().__init__(\n            data,\n            files,\n            auto_id,\n            prefix,\n            object_data,\n            error_class,\n            label_suffix,\n            empty_permitted,\n            use_required_attribute=use_required_attribute,\n            renderer=renderer,\n        )\n        for formfield in self.fields.values():\n            apply_limit_choices_to_to_formfield(formfield)\n            if isinstance(formfield, SimpleArrayField):\n                formfield.show_hidden_initial = False\n</replace>"
          },
          "output": {
            "diff": "--- django/forms/models.py\n+++ django/forms/models.py\n@@ -376,6 +376,8 @@\n         )\n         for formfield in self.fields.values():\n             apply_limit_choices_to_to_formfield(formfield)\n+            if isinstance(formfield, SimpleArrayField):\n+                formfield.show_hidden_initial = False\n \n     def _get_validation_exclusions(self):\n         \"\"\"\n",
            "message": "Applied the change to django/forms/models.py.\n\n<scratch_pad>\n```\n</scratch_pad>",
            "verification_errors": [
              {
                "code": "E0602",
                "line": 379,
                "message": "Undefined variable 'SimpleArrayField'",
                "file_path": "django/forms/models.py"
              }
            ]
          },
          "input_tokens": 7040,
          "output_tokens": 424,
          "retry_message": null,
          "completion_cost": 0.02748
        }
      ]
    },
    {
      "name": "PlanToCode",
      "state": {
        "diff": "--- django/forms/models.py\n+++ django/forms/models.py\n@@ -376,6 +376,8 @@\n         )\n         for formfield in self.fields.values():\n             apply_limit_choices_to_to_formfield(formfield)\n+            if isinstance(formfield, SimpleArrayField):\n+                formfield.show_hidden_initial = False\n \n     def _get_validation_exclusions(self):\n         \"\"\"\n",
        "model": "deepseek-coder",
        "message": "Applied the change to django/forms/models.py.\n\n<scratch_pad>\n```\n</scratch_pad>",
        "max_tokens": 1000,
        "temperature": 1.6,
        "max_iterations": 8,
        "finish_on_review": false,
        "verification_errors": [
          {
            "code": "E0602",
            "line": 379,
            "message": "Undefined variable 'SimpleArrayField'",
            "file_path": "django/forms/models.py"
          }
        ],
        "max_prompt_file_tokens": 4000,
        "include_message_history": true,
        "allow_hallucinated_spans": false,
        "max_tokens_in_edit_prompt": 500,
        "expand_context_with_related_spans": true
      },
      "actions": [
        {
          "action": {
            "action": "modify",
            "finish": null,
            "reject": null,
            "span_id": "imports",
            "file_path": "django/forms/models.py",
            "scratch_pad": "The previous change introduced a lint error due to an undefined variable 'SimpleArrayField'. This issue can be resolved by ensuring that the correct import for SimpleArrayField is added at the appropriate location in the file.",
            "instructions": "Add the correct import statement for SimpleArrayField in django/forms/models.py to resolve the lint error."
          },
          "output": null,
          "input_tokens": 7132,
          "output_tokens": 135,
          "retry_message": "Span not found: imports. Available spans: fields_for_model, BaseModelForm.__init__, apply_limit_choices_to_to_formfield, ModelFormMetaclass.__new__, model_to_dict, ModelFormOptions, ModelFormOptions.__init__",
          "completion_cost": 0.023421
        },
        {
          "action": {
            "action": "modify",
            "finish": null,
            "reject": null,
            "span_id": null,
            "file_path": "django/forms/models.py",
            "scratch_pad": "The initial request referenced an incorrect span identifier. The correct approach is to place the import statement at the top of the file to ensure all subsequent code can reference the SimpleArrayField class without causing a lint error.",
            "instructions": "Add the correct import statement for SimpleArrayField at the top of django/forms/models.py to resolve the lint error."
          },
          "output": null,
          "input_tokens": 7332,
          "output_tokens": 136,
          "retry_message": "You must either provide an apply_change action or finish.",
          "completion_cost": 0.024036000000000002
        },
        {
          "action": {
            "action": "modify",
            "finish": null,
            "reject": null,
            "span_id": null,
            "file_path": "django/forms/models.py",
            "scratch_pad": "To address the lint error and resolve the missing SimpleArrayField import, I will place the import statement at the top of django/forms/models.py where other imports are typically located.",
            "instructions": "Import the SimpleArrayField class at the top of django/forms/models.py by adding the line 'from django.contrib.postgres.forms import SimpleArrayField'."
          },
          "output": null,
          "input_tokens": 7487,
          "output_tokens": 142,
          "retry_message": "You must either provide an apply_change action or finish.",
          "completion_cost": 0.024591000000000002
        }
      ]
    }
  ],
  "initial_message": "ModelForm fields with callable defaults don't correctly propagate default values\nDescription\n\t\nWhen creating an object via the admin, if an inline contains an ArrayField in error, the validation will be bypassed (and the inline dismissed) if we submit the form a second time (without modification).\ngo to /admin/my_app/thing/add/\ntype anything in plop\nsubmit -> it shows an error on the inline\nsubmit again -> no errors, plop become unfilled\n# models.py\nclass Thing(models.Model):\n\tpass\nclass RelatedModel(models.Model):\n\tthing = models.ForeignKey(Thing, on_delete=models.CASCADE)\n\tplop = ArrayField(\n\t\tmodels.CharField(max_length=42),\n\t\tdefault=list,\n\t)\n# admin.py\nclass RelatedModelForm(forms.ModelForm):\n\tdef clean(self):\n\t\traise ValidationError(\"whatever\")\nclass RelatedModelInline(admin.TabularInline):\n\tform = RelatedModelForm\n\tmodel = RelatedModel\n\textra = 1\n@admin.register(Thing)\nclass ThingAdmin(admin.ModelAdmin):\n\tinlines = [\n\t\tRelatedModelInline\n\t]\nIt seems related to the hidden input containing the initial value:\n<input type=\"hidden\" name=\"initial-relatedmodel_set-0-plop\" value=\"test\" id=\"initial-relatedmodel_set-0-id_relatedmodel_set-0-plop\">\nI can fix the issue locally by forcing show_hidden_initial=False on the field (in the form init)\n"
}