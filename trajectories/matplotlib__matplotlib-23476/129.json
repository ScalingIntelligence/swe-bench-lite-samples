{
  "info": {
    "duration": 210.82673168182373,
    "submission": "diff --git a/lib/matplotlib/figure.py b/lib/matplotlib/figure.py\nindex c55864243a..7eb62d6f13 100644\n--- a/lib/matplotlib/figure.py\n+++ b/lib/matplotlib/figure.py\n@@ -3043,6 +3043,10 @@ class Figure(FigureBase):\n \n         self.__dict__ = state\n \n+        # Ensure the DPI attribute is correctly set without being doubled\n+        if 'dpi' in state:\n+            self._dpi = state['dpi']\n+\n         # re-initialise some of the unstored state information\n         FigureCanvasBase(self)  # Set self.canvas.\n \n",
    "total_cost": 0.144981,
    "instance_id": "matplotlib__matplotlib-23476",
    "evaluation_name": "run_on_remaining_250_for_july_4_t_1.6"
  },
  "name": "AgenticLoop",
  "transitions": [
    {
      "name": "SearchCode",
      "state": {
        "model": "deepseek-coder",
        "message": null,
        "max_tokens": 1000,
        "temperature": 1.6,
        "max_iterations": null,
        "max_search_results": 25,
        "support_test_files": false,
        "initial_context_tokens": 4000,
        "initial_search_results": 50,
        "include_message_history": true,
        "provide_initial_context": true,
        "initial_context_spans_per_file": 5,
        "max_retries_with_any_file_context": 3
      },
      "actions": [
        {
          "action": {
            "complete": false,
            "scratch_pad": "The issue relates to the DPI of a figure being doubled after unpickling on M1 Macs, which can lead to an `OverflowError`. The problem seems to be specific to the `__setstate__` method in the `Figure` class. Focusing on the `figure.py` file and the `Figure` class implementation would be a good starting point. Additionally, considering the backends, especially `backend_macosx.py`, might be relevant as the issue is Mac-specific.",
            "search_requests": [
              {
                "query": null,
                "class_names": [
                  "Figure"
                ],
                "code_snippet": null,
                "file_pattern": "**/figure.py",
                "function_names": []
              },
              {
                "query": null,
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/backend_macosx.py",
                "function_names": []
              }
            ]
          },
          "output": null,
          "input_tokens": 4963,
          "output_tokens": 187,
          "retry_message": "You must provide at least one the search attributes query, code_snippet, class_name or function_name to search. If you're finished, set finished to true.",
          "completion_cost": 0.017694
        },
        {
          "action": {
            "complete": false,
            "scratch_pad": "The issue relates to the DPI of a figure being doubled after unpickling on M1 Macs, leading to an `OverflowError`. The problem seems to be specific to the `__setstate__` method in the `Figure` class. Focusing on the `figure.py` file and the `Figure` class implementation would be a good starting point. Additionally, considering the backends, especially `backend_macosx.py`, might be relevant as the issue is Mac-specific.",
            "search_requests": [
              {
                "query": "DPI doubled after unpickling",
                "class_names": [
                  "Figure"
                ],
                "code_snippet": null,
                "file_pattern": "**/figure.py",
                "function_names": [
                  "__setstate__"
                ]
              },
              {
                "query": "DPI doubled after unpickling",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/backend_macosx.py",
                "function_names": []
              }
            ]
          },
          "output": {
            "complete": false,
            "ranked_spans": [
              {
                "rank": 0,
                "tokens": 141,
                "span_id": "Figure.__getstate__",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 1,
                "tokens": 61,
                "span_id": "Figure.add_axobserver",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 1,
                "tokens": 187,
                "span_id": "Figure.__setstate__",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 2,
                "tokens": 112,
                "span_id": "Figure._set_dpi",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 2,
                "tokens": 22,
                "span_id": "Figure:7",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 2,
                "tokens": 31,
                "span_id": "Figure.get_tight_layout",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 3,
                "tokens": 1588,
                "span_id": "Figure.__init__",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 5,
                "tokens": 57,
                "span_id": "Figure.clear",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 5,
                "tokens": 43,
                "span_id": "Figure.set_dpi",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 5,
                "tokens": 20,
                "span_id": "Figure.get_figwidth",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 5,
                "tokens": 22,
                "span_id": "Figure.get_dpi",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 5,
                "tokens": 20,
                "span_id": "Figure.get_figheight",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 5,
                "tokens": 85,
                "span_id": "Figure.set_figheight",
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "rank": 0,
                "tokens": 31,
                "span_id": "FigureManagerMac.show",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 0,
                "tokens": 24,
                "span_id": "_BackendMac",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 0,
                "tokens": 24,
                "span_id": "FigureManagerMac",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 0,
                "tokens": 17,
                "span_id": "FigureManagerMac._close_button_pressed",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 0,
                "tokens": 22,
                "span_id": "FigureManagerMac.close",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 0,
                "tokens": 13,
                "span_id": "_BackendMac.mainloop",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 1,
                "tokens": 41,
                "span_id": "TimerMac",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 1,
                "tokens": 80,
                "span_id": "imports",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 2,
                "tokens": 97,
                "span_id": "NavigationToolbar2Mac.save_figure",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 2,
                "tokens": 60,
                "span_id": "NavigationToolbar2Mac.prepare_configure_subplots",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 2,
                "tokens": 17,
                "span_id": "NavigationToolbar2Mac",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 2,
                "tokens": 43,
                "span_id": "NavigationToolbar2Mac.draw_rubberband",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              },
              {
                "rank": 2,
                "tokens": 14,
                "span_id": "NavigationToolbar2Mac.remove_rubberband",
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              }
            ],
            "search_requests": [
              {
                "query": "DPI doubled after unpickling",
                "class_names": [
                  "Figure"
                ],
                "code_snippet": null,
                "file_pattern": "**/figure.py",
                "function_names": [
                  "__setstate__"
                ]
              },
              {
                "query": "DPI doubled after unpickling",
                "class_names": [],
                "code_snippet": null,
                "file_pattern": "**/backend_macosx.py",
                "function_names": []
              }
            ]
          },
          "input_tokens": 5255,
          "output_tokens": 271,
          "retry_message": null,
          "completion_cost": 0.01983
        }
      ]
    },
    {
      "name": "IdentifyCode",
      "state": {
        "model": "deepseek-coder",
        "query": null,
        "class_name": null,
        "max_tokens": 1000,
        "temperature": 1.6,
        "code_snippet": null,
        "file_pattern": null,
        "ranked_spans": [
          {
            "rank": 0,
            "tokens": 141,
            "span_id": "Figure.__getstate__",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 1,
            "tokens": 61,
            "span_id": "Figure.add_axobserver",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 1,
            "tokens": 187,
            "span_id": "Figure.__setstate__",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 2,
            "tokens": 112,
            "span_id": "Figure._set_dpi",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 2,
            "tokens": 22,
            "span_id": "Figure:7",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 2,
            "tokens": 31,
            "span_id": "Figure.get_tight_layout",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 3,
            "tokens": 1588,
            "span_id": "Figure.__init__",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 5,
            "tokens": 57,
            "span_id": "Figure.clear",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 5,
            "tokens": 43,
            "span_id": "Figure.set_dpi",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 5,
            "tokens": 20,
            "span_id": "Figure.get_figwidth",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 5,
            "tokens": 22,
            "span_id": "Figure.get_dpi",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 5,
            "tokens": 20,
            "span_id": "Figure.get_figheight",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 5,
            "tokens": 85,
            "span_id": "Figure.set_figheight",
            "file_path": "lib/matplotlib/figure.py"
          },
          {
            "rank": 0,
            "tokens": 31,
            "span_id": "FigureManagerMac.show",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 0,
            "tokens": 24,
            "span_id": "_BackendMac",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 0,
            "tokens": 24,
            "span_id": "FigureManagerMac",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 0,
            "tokens": 17,
            "span_id": "FigureManagerMac._close_button_pressed",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 0,
            "tokens": 22,
            "span_id": "FigureManagerMac.close",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 0,
            "tokens": 13,
            "span_id": "_BackendMac.mainloop",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 1,
            "tokens": 41,
            "span_id": "TimerMac",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 1,
            "tokens": 80,
            "span_id": "imports",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 2,
            "tokens": 97,
            "span_id": "NavigationToolbar2Mac.save_figure",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 2,
            "tokens": 60,
            "span_id": "NavigationToolbar2Mac.prepare_configure_subplots",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 2,
            "tokens": 17,
            "span_id": "NavigationToolbar2Mac",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 2,
            "tokens": 43,
            "span_id": "NavigationToolbar2Mac.draw_rubberband",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          },
          {
            "rank": 2,
            "tokens": 14,
            "span_id": "NavigationToolbar2Mac.remove_rubberband",
            "file_path": "lib/matplotlib/backends/backend_macosx.py"
          }
        ],
        "function_name": null,
        "expand_context": true,
        "max_iterations": null,
        "max_prompt_file_tokens": 4000,
        "include_message_history": false
      },
      "actions": [
        {
          "action": {
            "scratch_pad": "The reported issue is a bug where the DPI of a figure doubles after unpickling on an M1 Mac. This anomaly leads to an `OverflowError`. The root cause seems to be related to how the figure's properties, especially DPI, are handled during the unpickling process. The provided search results include files and code spans that are likely relevant to this issue. Specifically, the `Figure` class and its methods in 'lib/matplotlib/figure.py' are central to how figures are managed and their DPI handled. The `backend_macosx.py` file also appears relevant, especially since the issue is specific to M1 Macs. Key methods include setting and getting the DPI, as well as the unpickling process itself. Additional context on how the figure is manipulated post-unpickling in the Mac OS backend will be insightful for a complete diagnosis. Further examination is advisable around the areas where DPI is adjusted or manipulated after figure restoration from pickled state. Ensuring that properties like DPI maintain consistent states pre and post-unpickling is crucial for resolving this bug. Given the detailed provided code, focusing on the `Figure.__setstate__` method and DPI manipulation logic is advisable. This should involve a thorough check on the initialization and re-initialization of the DPI attribute of the `Figure` class to ensure it remains consistent throughout different operations and platform-specific implementations.",
            "identified_spans": [
              {
                "span_ids": [
                  "Figure.",
                  "Figure.__init__",
                  "Figure.__setstate__",
                  "Figure._set_dpi",
                  "Figure.dpi",
                  "Figure.get_dpi",
                  "Figure.set_dpi"
                ],
                "file_path": "lib/matplotlib/figure.py"
              },
              {
                "span_ids": [
                  "imports",
                  "FigureCanvasMac"
                ],
                "file_path": "lib/matplotlib/backends/backend_macosx.py"
              }
            ]
          },
          "output": {},
          "input_tokens": 6175,
          "output_tokens": 463,
          "retry_message": null,
          "completion_cost": 0.02547
        }
      ]
    },
    {
      "name": "DecideRelevance",
      "state": {
        "model": "deepseek-coder",
        "max_tokens": 1000,
        "temperature": 1.6,
        "expand_context": true,
        "max_iterations": null,
        "max_prompt_file_tokens": 4000,
        "include_message_history": false,
        "finish_after_relevant_count": 2
      },
      "actions": [
        {
          "action": {
            "complete": true,
            "relevant": true,
            "scratch_pad": "The provided file context includes the relevant `Figure` class from `figure.py`, which contains the `__setstate__` method, and the `FigureCanvasMac` class from `backend_macosx.py`, which is the specific backend for Mac OS. These files directly address the issue of DPI doubling upon unpickling on M1 Macs. The code around the `__setstate__` method in `Figure` indicates how the figure is reinitialized after being unpickled, which is central to the problem described. The `FigureCanvasMac` class initialization also seems relevant as it is tied to the backend handling on macOS. Therefore, the file context appears to cover the necessary components associated with the reported issue.",
            "search_suggestions": null
          },
          "output": {},
          "input_tokens": 4782,
          "output_tokens": 187,
          "retry_message": null,
          "completion_cost": 0.017151
        }
      ]
    },
    {
      "name": "PlanToCode",
      "state": {
        "diff": null,
        "model": "deepseek-coder",
        "message": null,
        "max_tokens": 1000,
        "temperature": 1.6,
        "max_iterations": 8,
        "finish_on_review": false,
        "verification_errors": null,
        "max_prompt_file_tokens": 4000,
        "include_message_history": true,
        "allow_hallucinated_spans": false,
        "max_tokens_in_edit_prompt": 500,
        "expand_context_with_related_spans": true
      },
      "actions": [
        {
          "action": {
            "action": "modify",
            "finish": null,
            "reject": null,
            "span_id": "Figure.__setstate__",
            "file_path": "lib/matplotlib/figure.py",
            "scratch_pad": "The issue seems to be caused during the unpickling process of a figure on M1 Macs, where the DPI is doubled each time the figure is unpickled. A suitable place to address this would be the `__setstate__` method in the `Figure` class, ensuring that the DPI attribute is correctly restored without being doubled.",
            "instructions": "In the `__setstate__` method of the `Figure` class, ensure that the DPI attribute is correctly set without being doubled. This can be achieved by explicitly setting the `dpi` attribute to the value in the state dictionary."
          },
          "output": {
            "span_id": "Figure.__setstate__",
            "end_line": 3059,
            "file_path": "lib/matplotlib/figure.py",
            "start_line": 3035,
            "instructions": "In the `__setstate__` method of the `Figure` class, ensure that the DPI attribute is correctly set without being doubled. This can be achieved by explicitly setting the `dpi` attribute to the value in the state dictionary."
          },
          "input_tokens": 5502,
          "output_tokens": 181,
          "retry_message": null,
          "completion_cost": 0.019221
        }
      ]
    },
    {
      "name": "EditCode",
      "state": {
        "model": "deepseek-coder",
        "verify": true,
        "span_id": "Figure.__setstate__",
        "end_line": 3059,
        "file_path": "lib/matplotlib/figure.py",
        "max_tokens": 1000,
        "start_line": 3035,
        "temperature": 1.6,
        "instructions": "In the `__setstate__` method of the `Figure` class, ensure that the DPI attribute is correctly set without being doubled. This can be achieved by explicitly setting the `dpi` attribute to the value in the state dictionary.",
        "max_iterations": 8,
        "chain_of_thought": false,
        "show_file_context": true,
        "show_initial_message": true,
        "max_prompt_file_tokens": 4000,
        "include_message_history": true
      },
      "actions": [
        {
          "action": {
            "content": "<replace>\n    def __setstate__(self, state):\n        version = state.pop('__mpl_version__')\n        restore_to_pylab = state.pop('_restore_to_pylab', False)\n\n        if version != mpl.__version__:\n            _api.warn_external(\n                f\"This figure was saved with matplotlib version {version} and \"\n                f\"is unlikely to function correctly.\")\n\n        self.__dict__ = state\n\n        # Ensure the DPI attribute is correctly set without being doubled\n        if 'dpi' in state:\n            self._dpi = state['dpi']\n\n        # re-initialise some of the unstored state information\n        FigureCanvasBase(self)  # Set self.canvas.\n\n        if restore_to_pylab:\n            # lazy import to avoid circularity\n            import matplotlib.pyplot as plt\n            import matplotlib._pylab_helpers as pylab_helpers\n            allnums = plt.get_fignums()\n            num = max(allnums) + 1 if allnums else 1\n            mgr = plt._backend_mod.new_figure_manager_given_figure(num, self)\n            pylab_helpers.Gcf._set_new_active_manager(mgr)\n            plt.draw_if_interactive()\n\n        self.stale = True\n</replace>"
          },
          "output": {
            "diff": "--- lib/matplotlib/figure.py\n+++ lib/matplotlib/figure.py\n@@ -3043,6 +3043,10 @@\n \n         self.__dict__ = state\n \n+        # Ensure the DPI attribute is correctly set without being doubled\n+        if 'dpi' in state:\n+            self._dpi = state['dpi']\n+\n         # re-initialise some of the unstored state information\n         FigureCanvasBase(self)  # Set self.canvas.\n \n",
            "message": "Applied the change to lib/matplotlib/figure.py.",
            "verification_errors": []
          },
          "input_tokens": 6586,
          "output_tokens": 319,
          "retry_message": null,
          "completion_cost": 0.024543000000000002
        }
      ]
    },
    {
      "name": "PlanToCode",
      "state": {
        "diff": "--- lib/matplotlib/figure.py\n+++ lib/matplotlib/figure.py\n@@ -3043,6 +3043,10 @@\n \n         self.__dict__ = state\n \n+        # Ensure the DPI attribute is correctly set without being doubled\n+        if 'dpi' in state:\n+            self._dpi = state['dpi']\n+\n         # re-initialise some of the unstored state information\n         FigureCanvasBase(self)  # Set self.canvas.\n \n",
        "model": "deepseek-coder",
        "message": "Applied the change to lib/matplotlib/figure.py.",
        "max_tokens": 1000,
        "temperature": 1.6,
        "max_iterations": 8,
        "finish_on_review": false,
        "verification_errors": [],
        "max_prompt_file_tokens": 4000,
        "include_message_history": true,
        "allow_hallucinated_spans": false,
        "max_tokens_in_edit_prompt": 500,
        "expand_context_with_related_spans": true
      },
      "actions": [
        {
          "action": {
            "action": "finish",
            "finish": "The issue should now be resolved with the change applied. The DPI attribute is correctly restored during unpickling, preventing the doubling of DPI values on M1 Macs.",
            "reject": null,
            "span_id": null,
            "file_path": null,
            "scratch_pad": "The changes applied to the `__setstate__` method in the `Figure` class should address the issue of the DPI being doubled upon unpickling on M1 Macs. By explicitly setting the `dpi` attribute to the value in the state dictionary, we ensure that the DPI is correctly restored without being doubled.",
            "instructions": null
          },
          "output": {
            "message": "The issue should now be resolved with the change applied. The DPI attribute is correctly restored during unpickling, preventing the doubling of DPI values on M1 Macs."
          },
          "input_tokens": 6209,
          "output_tokens": 163,
          "retry_message": null,
          "completion_cost": 0.021072
        }
      ]
    },
    {
      "name": "Finished",
      "state": {
        "model": "gpt-4o",
        "output": {
          "model": "deepseek-coder",
          "temperature": 1.6
        },
        "message": "The issue should now be resolved with the change applied. The DPI attribute is correctly restored during unpickling, preventing the doubling of DPI values on M1 Macs.",
        "max_tokens": 1000,
        "temperature": 0.0,
        "max_iterations": null,
        "include_message_history": false
      },
      "actions": []
    }
  ],
  "initial_message": "[Bug]: DPI of a figure is doubled after unpickling on M1 Mac\n### Bug summary\r\n\r\nWhen a figure is unpickled, it's dpi is doubled. This behaviour happens every time and if done in a loop it can cause an `OverflowError`.\r\n\r\n### Code for reproduction\r\n\r\n```python\r\nimport numpy as np\r\nimport matplotlib\r\nimport matplotlib.pyplot as plt\r\nimport pickle\r\nimport platform\r\n\r\nprint(matplotlib.get_backend())\r\nprint('Matplotlib ver:', matplotlib.__version__)\r\nprint('Platform:', platform.platform())\r\nprint('System:', platform.system())\r\nprint('Release:', platform.release())\r\nprint('Python ver:', platform.python_version())\r\n\r\n\r\ndef dump_load_get_dpi(fig):\r\n    with open('sinus.pickle','wb') as file:\r\n        pickle.dump(fig, file)\r\n\r\n    with open('sinus.pickle', 'rb') as blob:\r\n        fig2 = pickle.load(blob)\r\n    return fig2, fig2.dpi\r\n\r\n\r\ndef run():\r\n    fig = plt.figure()\r\n    x = np.linspace(0,2*np.pi)\r\n    y = np.sin(x)\r\n\r\n    for i in range(32):\r\n        print(f'{i}: {fig.dpi}')\r\n        fig, dpi = dump_load_get_dpi(fig)\r\n\r\n\r\nif __name__ == '__main__':\r\n    run()\r\n```\r\n\r\n\r\n### Actual outcome\r\n\r\n```\r\nMacOSX\r\nMatplotlib ver: 3.5.2\r\nPlatform: macOS-12.4-arm64-arm-64bit\r\nSystem: Darwin\r\nRelease: 21.5.0\r\nPython ver: 3.9.12\r\n0: 200.0\r\n1: 400.0\r\n2: 800.0\r\n3: 1600.0\r\n4: 3200.0\r\n5: 6400.0\r\n6: 12800.0\r\n7: 25600.0\r\n8: 51200.0\r\n9: 102400.0\r\n10: 204800.0\r\n11: 409600.0\r\n12: 819200.0\r\n13: 1638400.0\r\n14: 3276800.0\r\n15: 6553600.0\r\n16: 13107200.0\r\n17: 26214400.0\r\n18: 52428800.0\r\n19: 104857600.0\r\n20: 209715200.0\r\n21: 419430400.0\r\nTraceback (most recent call last):\r\n  File \"/Users/wsykala/projects/matplotlib/example.py\", line 34, in <module>\r\n    run()\r\n  File \"/Users/wsykala/projects/matplotlib/example.py\", line 30, in run\r\n    fig, dpi = dump_load_get_dpi(fig)\r\n  File \"/Users/wsykala/projects/matplotlib/example.py\", line 20, in dump_load_get_dpi\r\n    fig2 = pickle.load(blob)\r\n  File \"/Users/wsykala/miniconda3/envs/playground/lib/python3.9/site-packages/matplotlib/figure.py\", line 2911, in __setstate__\r\n    mgr = plt._backend_mod.new_figure_manager_given_figure(num, self)\r\n  File \"/Users/wsykala/miniconda3/envs/playground/lib/python3.9/site-packages/matplotlib/backend_bases.py\", line 3499, in new_figure_manager_given_figure\r\n    canvas = cls.FigureCanvas(figure)\r\n  File \"/Users/wsykala/miniconda3/envs/playground/lib/python3.9/site-packages/matplotlib/backends/backend_macosx.py\", line 32, in __init__\r\n    _macosx.FigureCanvas.__init__(self, width, height)\r\nOverflowError: signed integer is greater than maximum\r\n```\r\n\r\n### Expected outcome\r\n\r\n```\r\nMacOSX\r\nMatplotlib ver: 3.5.2\r\nPlatform: macOS-12.4-arm64-arm-64bit\r\nSystem: Darwin\r\nRelease: 21.5.0\r\nPython ver: 3.9.12\r\n0: 200.0\r\n1: 200.0\r\n2: 200.0\r\n3: 200.0\r\n4: 200.0\r\n5: 200.0\r\n6: 200.0\r\n7: 200.0\r\n8: 200.0\r\n9: 200.0\r\n10: 200.0\r\n11: 200.0\r\n12: 200.0\r\n13: 200.0\r\n14: 200.0\r\n15: 200.0\r\n16: 200.0\r\n17: 200.0\r\n18: 200.0\r\n19: 200.0\r\n20: 200.0\r\n21: 200.0\r\n22: 200.0\r\n```\r\n\r\n### Additional information\r\n\r\nThis seems to happen only on M1 MacBooks and the version of python doesn't matter.\r\n\r\n### Operating system\r\n\r\nOS/X\r\n\r\n### Matplotlib Version\r\n\r\n3.5.2\r\n\r\n### Matplotlib Backend\r\n\r\nMacOSX\r\n\r\n### Python version\r\n\r\n3.9.12\r\n\r\n### Jupyter version\r\n\r\n_No response_\r\n\r\n### Installation\r\n\r\npip\n"
}